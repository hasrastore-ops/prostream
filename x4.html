<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TitanX-H11 - Jam Tangan Pintar Generasi Terbaru</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/d1.webp" as="image">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" as="style">
    
    <!-- Meta Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '810870364294543');
    fbq('track', 'PageView');

    // Simplified event tracking functions
    function trackAddToCart(quantity = 1) {
      fbq('track', 'AddToCart', {
        content_name: 'TitanX-H11 Smartwatch',
        content_category: 'Watches',
        content_ids: ['titanx-h11'],
        content_type: 'product',
        value: 89.90 * quantity,
        currency: 'MYR'
      });
    }

    function trackInitiateCheckout(quantity, totalValue) {
      fbq('track', 'InitiateCheckout', {
        content_ids: ['titanx-h11'],
        content_type: 'product',
        value: totalValue,
        currency: 'MYR',
        num_items: quantity
      });
    }

    function trackPurchase(quantity, totalValue) {
      fbq('track', 'Purchase', {
        content_ids: ['titanx-h11'],
        content_type: 'product',
        value: totalValue,
        currency: 'MYR',
        num_items: quantity
      });
    }
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=810870364294543&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Meta Pixel Code -->
    
    <style>
        :root {
            --primary-color: #8b5cf6;
            --secondary-color: #7c3aed;
            --accent-color: #f59e0b;
            --text-light: #e5e7eb;
            --text-dark: #9ca3af;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --midnight-navy: #0C1F3D;
            --royal-sapphire: #1E3A8A;
            --antique-gold: #D4AF37;
            --platinum-silver: #C0C0C0;
            --voucher-blue: #0c2e5a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-dark);
            color: var(--text-light);
            overflow-x: hidden;
        }

        /* Header Styles */
        .navbar {
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
            padding: 15px 0;
        }

        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--primary-color);
        }

        .nav-link {
            font-weight: 500;
            margin: 0 10px;
            transition: color 0.3s ease;
            color: var(--text-light);
        }

        .nav-link:hover {
            color: var(--primary-color);
        }

        .btn-primary-custom {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border: none;
            padding: 12px 25px;
            font-weight: 600;
            border-radius: 50px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
        }

        .btn-primary-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
        }

        /* Cart Badge */
        .cart-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--accent-color);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        /* Hero Section */
        .hero-section {
            padding: 100px 0 80px;
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
            position: relative;
            overflow: hidden;
        }

        .hero-content h1 {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 20px;
            color: white;
            line-height: 1.2;
            animation: fadeInUp 0.8s ease;
        }

        .hero-content p {
            font-size: 1.25rem;
            margin-bottom: 30px;
            color: rgba(255, 255, 255, 0.9);
            animation: fadeInUp 0.8s ease 0.2s;
            animation-fill-mode: both;
        }

        .hero-image {
            position: relative;
            animation: float 3s ease-in-out infinite;
        }

        .hero-image img {
            max-width: 100%;
            height: auto;
            border-radius: 20px;
        }

        .floating-badges {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 10;
        }

        .badge-float {
            background: var(--bg-card);
            color: var(--text-light);
            padding: 8px 15px;
            border-radius: 50px;
            font-weight: 600;
            margin-bottom: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            animation: slideInRight 0.8s ease;
            border: 1px solid var(--bg-hover);
        }

        /* Stock Counter */
        .stock-counter {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
            padding: 10px 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: 600;
        }

        /* Trust Indicators */
        .trust-indicators {
            background: var(--bg-card);
            padding: 20px 0;
            border-bottom: 1px solid var(--bg-hover);
        }

        .trust-item {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
        }

        .trust-item i {
            color: var(--accent-color);
            margin-right: 10px;
            font-size: 1.5rem;
        }

        /* Features Section - Updated */
        .features-section {
            padding: 80px 0;
            background: var(--bg-dark);
        }

        .feature-image-container {
            margin-bottom: 30px;
            overflow: hidden;
            border-radius: 0;
        }

        .feature-image {
            width: 100%;
            height: auto;
            display: block;
            transition: transform 0.3s ease;
        }

        .feature-image:hover {
            transform: scale(1.05);
        }

        /* Video Section */
        .video-section {
            padding: 80px 0;
            background: var(--bg-card);
        }

        .video-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            aspect-ratio: 9/16;
            background: #000;
            border-radius: 20px;
            overflow: hidden;
        }

        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.3);
            cursor: pointer;
            z-index: 2;
        }

        .play-button {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .play-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .play-button i {
            color: white;
            font-size: 2.5rem;
        }

        /* Video Controls */
        .video-controls {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 15px;
            z-index: 3;
        }

        .video-control-btn {
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .video-control-btn:hover {
            background: rgba(0, 0, 0, 0.7);
            transform: scale(1.1);
        }

        /* Testimonials Section */
        .testimonials-section {
            padding: 80px 0;
            background: var(--bg-card);
        }

        .testimonial-card {
            background: var(--bg-dark);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--bg-hover);
        }

        .testimonial-stars {
            color: var(--accent-color);
            margin-bottom: 15px;
        }

        .testimonial-text {
            color: var(--text-light);
        }

        /* WhatsApp Reviews Section */
        .whatsapp-reviews-section {
            padding: 80px 0;
            background: var(--bg-dark);
        }

        .whatsapp-reviews-container {
            position: relative;
            width: 100%;
            overflow: hidden;
            margin: 0 auto;
            max-width: 1200px;
        }

        .whatsapp-reviews-scroll {
            display: flex;
            overflow-x: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--accent-color);
            scroll-behavior: smooth;
            padding: 20px 0;
        }

        .whatsapp-reviews-scroll::-webkit-scrollbar {
            height: 8px;
        }

        .whatsapp-reviews-scroll::-webkit-scrollbar-track {
            background: var(--bg-hover);
            border-radius: 4px;
        }

        .whatsapp-reviews-scroll::-webkit-scrollbar-thumb {
            background: var(--accent-color);
            border-radius: 4px;
        }

        .whatsapp-review {
            flex: 0 0 auto;
            width: 300px;
            height: 534px; /* 9:16 aspect ratio */
            margin: 0 10px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .whatsapp-review:hover {
            transform: scale(1.03);
        }

        .whatsapp-review img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        /* Auto-scroll functionality */
        @keyframes scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }

        /* Mobile responsiveness */
        @media(max-width: 768px) {
            .whatsapp-review {
                width: 250px;
                height: 444px; /* Maintain 9:16 aspect ratio */
            }
        }

        /* Pricing Section */
        .pricing-section {
            padding: 80px 0;
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
            position: relative;
        }

        .pricing-card {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            position: relative;
            overflow: hidden;
            border: 1px solid var(--bg-hover);
        }

        .price-tag {
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary-color);
            margin: 20px 0;
        }

        .original-price {
            text-decoration: line-through;
            color: var(--text-dark);
            font-size: 1.5rem;
        }

        .discount-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--accent-color);
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: 700;
            transform: rotate(15deg);
        }

        /* Color Variations - Updated for Mobile */
        .color-variation {
            margin-bottom: 20px;
        }

        .color-option {
            position: relative;
            border-radius: 15px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .color-option.active {
            border-color: var(--primary-color);
            transform: scale(1.05);
        }

        .color-option.sold-out {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .color-option img {
            width: 100%;
            height: auto;
            display: block;
        }

        .color-label {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px;
            text-align: center;
            font-weight: 600;
        }

        .sold-out-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ef4444;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-weight: 600;
            font-size: 12px;
        }

        /* Countdown Timer */
        .countdown-section {
            background: var(--bg-card);
            color: var(--text-light);
            padding: 40px 0;
            text-align: center;
            border-top: 1px solid var(--bg-hover);
        }

        .countdown-timer {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }

        .countdown-item {
            background: var(--bg-dark);
            border-radius: 10px;
            padding: 15px 20px;
            min-width: 80px;
            border: 1px solid var(--bg-hover);
        }

        .countdown-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .countdown-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* WhatsApp Button */
        .whatsapp-float {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .whatsapp-button {
            background: #25d366;
            color: white;
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 30px;
            box-shadow: 0 4px 20px rgba(37, 211, 102, 0.4);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .whatsapp-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 30px rgba(37, 211, 102, 0.6);
        }

        .whatsapp-tooltip {
            position: absolute;
            bottom: 70px;
            right: 0;
            background: var(--bg-card);
            color: var(--text-light);
            padding: 10px 15px;
            border-radius: 10px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            border: 1px solid var(--bg-hover);
            font-size: 14px;
        }

        .whatsapp-float:hover .whatsapp-tooltip {
            opacity: 1;
        }

        /* Order Button */
        .order-float {
            position: fixed;
            bottom: 30px;
            left: 30px;
            z-index: 1000;
        }

        .order-button {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 16px;
            box-shadow: 0 4px 20px rgba(139, 92, 246, 0.4);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .order-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 30px rgba(139, 92, 246, 0.6);
        }

        .order-tooltip {
            position: absolute;
            bottom: 70px;
            left: 0;
            background: var(--bg-card);
            color: var(--text-light);
            padding: 10px 15px;
            border-radius: 10px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            border: 1px solid var(--bg-hover);
            font-size: 14px;
        }

        .order-float:hover .order-tooltip {
            opacity: 1;
        }

        /* Cart Sidebar */
        .cart-sidebar {
            position: fixed;
            right: -400px;
            top: 0;
            width: 400px;
            height: 100vh;
            background: var(--bg-card);
            box-shadow: -5px 0 20px rgba(0, 0, 0, 0.5);
            transition: right 0.3s ease;
            z-index: 1100;
            overflow-y: auto;
        }

        .cart-sidebar.active {
            right: 0;
        }

        .cart-header {
            background: var(--bg-dark);
            padding: 20px;
            border-bottom: 1px solid var(--bg-hover);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-body {
            padding: 20px;
        }

        .cart-item {
            background: var(--bg-dark);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .cart-footer {
            position: sticky;
            bottom: 0;
            background: var(--bg-dark);
            padding: 20px;
            border-top: 1px solid var(--bg-hover);
        }

        .cart-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 1099;
        }

        .cart-overlay.active {
            display: block;
        }

        /* Collapsible Facts */
        .facts-section {
            padding: 40px 0;
            background: var(--bg-card);
        }

        .fact-item {
            margin-bottom: 15px;
            border: 1px solid var(--bg-hover);
            border-radius: 10px;
            overflow: hidden;
        }

        .fact-header {
            background: var(--bg-dark);
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
        }

        .fact-header:hover {
            background: var(--bg-hover);
        }

        .fact-title {
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .fact-title i {
            margin-right: 10px;
            color: var(--primary-color);
        }

        .fact-icon {
            transition: transform 0.3s ease;
        }

        .fact-item.active .fact-icon {
            transform: rotate(180deg);
        }

        .fact-content {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, padding 0.3s ease;
        }

        .fact-item.active .fact-content {
            padding: 15px 20px;
            max-height: 300px;
        }

        /* Checkout Modal */
        .checkout-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            overflow-y: auto;
        }

        .checkout-modal.active {
            display: block;
        }

        .checkout-content {
            background: var(--bg-card);
            max-width: 600px;
            margin: 50px auto;
            border-radius: 20px;
            padding: 30px;
            position: relative;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background: transparent;
            border: none;
            color: var(--text-light);
            font-size: 24px;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            background: var(--bg-dark);
            border: 1px solid var(--bg-hover);
            border-radius: 8px;
            color: white;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2);
        }

        .error-message {
            color: #ef4444;
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }

        .form-control.error {
            border-color: #ef4444;
        }

        .payment-option {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 15px;
            background: var(--bg-dark);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .payment-option:hover {
            background: var(--bg-hover);
        }

        .payment-option input {
            margin-right: 10px;
        }

        .success-message {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: #10b981;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }

        .whatsapp-confirm {
            background: #25d366;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: block;
            width: 100%;
            margin-top: 20px;
            text-align: center;
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-20px);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Mobile Optimizations */
        @media(max-width: 768px) {
            .hero-content h1 {
                font-size: 2.5rem;
            }
            
            .hero-section {
                padding: 80px 0 60px;
            }
            
            .cart-sidebar {
                width: 100%;
                right: -100%;
            }
            
            .countdown-timer {
                gap: 10px;
            }
            
            .countdown-item {
                min-width: 60px;
                padding: 10px 15px;
            }
            
            .countdown-value {
                font-size: 1.5rem;
            }
            
            .order-button {
                padding: 12px 20px;
                font-size: 14px;
            }
            
            .checkout-content {
                margin: 20px;
                padding: 20px;
            }
            
            /* Make color selection images bigger on mobile */
            .color-option {
                height: 180px; /* Increased height for mobile */
            }
            
            .color-option img {
                height: 100%;
                object-fit: cover; /* Ensure images cover the container */
            }
        }
        
        /* Enhanced Mobile Experience */
        @media(max-width: 576px) {
            .hero-content h1 {
                font-size: 1.8rem;
            }
            
            .price-tag {
                font-size: 2rem;
            }
            
            .floating-badges {
                top: 10px;
                right: 10px;
            }
            
            .badge-float {
                font-size: 0.8rem;
                padding: 5px 10px;
            }
            
            .mobile-sticky-checkout {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: var(--bg-card);
                padding: 15px;
                z-index: 1000;
                display: flex;
                justify-content: space-between;
                align-items: center;
                box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.3);
            }
            
            .mobile-sticky-checkout .price {
                font-weight: 700;
                color: var(--primary-color);
                font-size: 1.2rem;
            }
            
            .mobile-sticky-checkout .btn {
                padding: 10px 20px;
                font-weight: 600;
            }
            
            .video-controls {
                bottom: 10px;
            }
            
            .video-control-btn {
                width: 40px;
                height: 40px;
            }
            
            .color-option {
                height: 150px;
            }
            
            .countdown-timer {
                gap: 5px;
            }
            
            .countdown-item {
                min-width: 50px;
                padding: 8px 10px;
            }
            
            .countdown-value {
                font-size: 1.2rem;
            }
        }
        
        /* Enhanced Cart Styles */
        .discount-info {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            display: none;
        }
        
        .discount-info.show {
            display: block;
        }
        
        .price-breakdown {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .price-breakdown.original {
            text-decoration: line-through;
            color: var(--text-dark);
        }
        
        .price-breakdown.discount {
            color: #10b981;
            font-weight: 700;
        }
        
        .cart-item-details .voucher-note {
            color: var(--primary-color);
            font-size: 0.85rem;
            margin-bottom: 4px;
            font-style: italic;
        }
        
        .cart-item-details .savings-message {
            color: #10b981;
            font-weight: 600;
            font-size: 0.9rem;
            margin-top: 4px;
            margin-bottom: 0;
        }
        
        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .loading-content {
            background-color: var(--bg-card);
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 400px;
            width: 90%;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        
        .loading-overlay.active .loading-content {
            transform: scale(1);
        }
        
        .loading-spinner {
            display: inline-block;
            width: 60px;
            height: 60px;
            border: 6px solid rgba(139, 92, 246, 0.2);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 25px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 20px;
            font-weight: 600;
            color: var(--text-light);
            margin-bottom: 15px;
        }
        
        .loading-subtext {
            font-size: 16px;
            color: var(--text-dark);
            line-height: 1.5;
        }
        
        .loading-progress {
            height: 6px;
            width: 100%;
            background-color: var(--bg-dark);
            border-radius: 3px;
            margin-top: 20px;
            overflow: hidden;
        }
        
        .loading-progress-bar {
            height: 100%;
            width: 0;
            background-color: var(--primary-color);
            border-radius: 3px;
            animation: progress 3s ease-in-out infinite;
        }
        
        @keyframes progress {
            0% { width: 0%; }
            50% { width: 70%; }
            100% { width: 100%; }
        }
        
        /* Payment Redirect Modal */
        .payment-redirect-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1050;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease;
        }
        
        .payment-redirect-modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .payment-redirect-modal-content {
            background: var(--bg-card);
            border-radius: 0.75rem;
            width: 90%;
            max-width: 500px;
            padding: 2rem;
            transform: scale(0.9);
            transition: transform 0.3s ease;
            text-align: center;
        }
        
        .payment-redirect-modal.active .payment-redirect-modal-content {
            transform: scale(1);
        }
        
        /* Voucher Popup */
        .voucher-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        
        .voucher-popup.active {
            opacity: 1;
            visibility: visible;
        }
        
        .voucher-content {
            background-color: var(--bg-card);
            border-radius: 15px;
            padding: 30px;
            max-width: 450px;
            width: 90%;
            text-align: center;
            color: var(--text-light);
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transform: scale(0.9);
            transition: transform 0.3s;
        }
        
        .voucher-popup.active .voucher-content {
            transform: scale(1);
        }
        
        .voucher-close {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            color: var(--text-light);
            cursor: pointer;
            background: none;
            border: none;
        }
        
        .voucher-icon {
            font-size: 60px;
            color: var(--accent-color);
            margin-bottom: 20px;
        }
        
        .voucher-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 15px;
        }
        
        .voucher-amount {
            font-size: 36px;
            font-weight: 700;
            color: var(--accent-color);
            margin-bottom: 15px;
        }
        
        .voucher-description {
            font-size: 16px;
            margin-bottom: 25px;
            line-height: 1.5;
        }
        
        .voucher-timer {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .timer-unit {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 10px;
            min-width: 70px;
        }
        
        .timer-value {
            font-size: 24px;
            font-weight: 700;
            display: block;
        }
        
        .timer-label {
            font-size: 12px;
            text-transform: uppercase;
        }
        
        .voucher-claim-btn {
            background-color: var(--accent-color);
            color: var(--bg-dark);
            border: none;
            border-radius: 30px;
            padding: 15px 40px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: block;
            margin: 0 auto;
        }
        
        .voucher-claim-btn:hover {
            background-color: #d4940b;
            transform: translateY(-3px);
        }
        
        /* Notification Container */
        .notification-container {
            position: fixed;
            bottom: 90px;
            right: 20px;
            z-index: 999;
            width: 300px;
        }
        
        .notification {
            background: var(--bg-card);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            animation: slideIn 0.5s ease-out;
            position: relative;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .notification-content {
            flex-grow: 1;
        }
        
        .notification-title {
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--text-light);
        }
        
        .notification-message {
            font-size: 0.9rem;
            color: var(--text-dark);
        }
        
        .notification-close {
            position: absolute;
            top: 5px;
            right: 5px;
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--text-dark);
        }

        /* Order Confirmation Modal */
        .order-confirmation-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 3000;
            overflow-y: auto;
        }

        .order-confirmation-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .order-confirmation-content {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            position: relative;
            animation: fadeInUp 0.5s ease;
        }

        .order-success-icon {
            font-size: 5rem;
            color: #10b981;
            margin-bottom: 20px;
        }

        .order-confirmation-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-light);
            margin-bottom: 15px;
        }

        .order-confirmation-message {
            color: var(--text-dark);
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .order-details {
            background: var(--bg-dark);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .order-detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .order-detail-label {
            color: var(--text-dark);
        }

        .order-detail-value {
            color: var(--text-light);
            font-weight: 600;
        }

        .order-total-row {
            border-top: 1px solid var(--bg-hover);
            padding-top: 10px;
            margin-top: 10px;
        }

        .order-total-value {
            color: var(--primary-color);
            font-size: 1.2rem;
        }

        .whatsapp-cta {
            background: #25d366;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
            text-decoration: none;
        }

        .whatsapp-cta:hover {
            background: #128c7e;
            transform: translateY(-2px);
        }

        .close-confirmation {
            position: absolute;
            top: 15px;
            right: 15px;
            background: transparent;
            border: none;
            color: var(--text-light);
            font-size: 24px;
            cursor: pointer;
        }
        
        /* Online Payment Confirmation Modal */
        .online-payment-confirmation-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 3000;
            overflow-y: auto;
        }

        .online-payment-confirmation-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .online-payment-confirmation-content {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            position: relative;
            animation: fadeInUp 0.5s ease;
        }

        .online-payment-success-icon {
            font-size: 5rem;
            color: #10b981;
            margin-bottom: 20px;
        }

        .online-payment-confirmation-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-light);
            margin-bottom: 15px;
        }

        .online-payment-confirmation-message {
            color: var(--text-dark);
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .online-payment-details {
            background: var(--bg-dark);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .online-payment-detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .online-payment-detail-label {
            color: var(--text-dark);
        }

        .online-payment-detail-value {
            color: var(--text-light);
            font-weight: 600;
        }

        .online-payment-total-row {
            border-top: 1px solid var(--bg-hover);
            padding-top: 10px;
            margin-top: 10px;
        }

        .online-payment-total-value {
            color: var(--primary-color);
            font-size: 1.2rem;
        }

        .online-payment-cta {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }

        .online-payment-cta:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
        }

        .close-online-payment-confirmation {
            position: absolute;
            top: 15px;
            right: 15px;
            background: transparent;
            border: none;
            color: var(--text-light);
            font-size: 24px;
            cursor: pointer;
        }
        
        /* Social Proof Notifications */
        .social-proof-notification {
            display: flex;
            align-items: center;
            background: var(--bg-card);
            border-left: 4px solid var(--primary-color);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            margin-bottom: 10px;
            animation: slideInRight 0.5s ease-out;
            transition: opacity 0.3s ease;
        }

        .notification-icon {
            margin-right: 15px;
            color: var(--primary-color);
            font-size: 1.2rem;
        }

        .notification-content p {
            margin: 0;
            font-size: 0.9rem;
            color: var(--text-light);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#"><i class="fas fa-clock"></i> HASRASTORE</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="#features">Ciri-ciri</a></li>
                    <li class="nav-item"><a class="nav-link" href="#testimonials">Ulasan</a></li>
                    <li class="nav-item"><a class="nav-link" href="#pricing">Harga</a></li>
                    <li class="nav-item">
                        <button class="btn btn-primary-custom ms-3 position-relative" onclick="toggleCart()">
                            <i class="fas fa-shopping-cart"></i> Troli
                            <span class="cart-badge" id="cartBadge">0</span>
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6 hero-content">
                    <h1>TitanX-H11: Dibina Untuk Ketahanan, Direka Untuk Gaya.</h1>
                    <p>Pantau kesihatan, kekal aktif, dan nampak bergaya, semua dalam satu jam pintar lasak dengan rekaan yang memukau.</p>
                    <div class="stock-counter">
                        <i class="fas fa-fire me-2"></i> 13 unit tinggal - Jangan ketinggalan!
                    </div>
                    <div class="d-flex flex-column flex-sm-row gap-3">
                        <button class="btn btn-light btn-lg px-4 py-3" onclick="scrollToPricing()">
                            <i class="fas fa-shopping-cart me-2"></i> Beli Sekarang - Jimat RM99.10
                        </button>
                        <button class="btn btn-outline-light btn-lg px-4 py-3" onclick="showVideo()">
                            <i class="fas fa-play-circle me-2"></i> Lihat Video
                        </button>
                    </div>
                    <div class="mt-4">
                        <small class="text-white-50"><i class="fas fa-truck me-2"></i> Penghantaran Percuma | Warranty 1 Bulan</small>
                    </div>
                </div>
                <div class="col-lg-6 hero-image">
                    <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/d1.webp" alt="TitanX-H11 Smartwatch" class="img-fluid">
                    <div class="floating-badges">
                        <div class="badge-float"><i class="fas fa-star text-warning"></i> 4.9/5 Rating</div>
                        <div class="badge-float"><i class="fas fa-users text-info"></i> <span id="buyersToday">26</span> pembeli hari ini</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Trust Indicators -->
    <section class="trust-indicators">
        <div class="container">
            <div class="row">
                <div class="col-6 col-md-3 trust-item">
                    <i class="fas fa-shield-alt"></i>
                    <span>Pembayaran Selamat- FPX, Maybank, QR </span>
                </div>
                <div class="col-6 col-md-3 trust-item">
                    <i class="fas fa-award"></i>
                    <span>Kualiti Premium</span>
                </div>
                <div class="col-6 col-md-3 trust-item">
                    <i class="fas fa-users"></i>
                    <span>50K+ Pembeli Berpuas Hati </span>
                </div>
                <div class="col-6 col-md-3 trust-item">
                    <i class="fas fa-bolt"></i>
                    <span>Penghantaran Pantas 1-3 Hari </span>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section - Updated -->
    <section class="features-section" id="features">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="display-4 fw-bold text-white">Fungsi Khas Jam</h2>
            </div>
            <div class="row">
                <div class="col-md-4 mb-4">
                    <div class="feature-image-container">
                        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/d1.webp" alt="Health Monitoring" class="feature-image">
                        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/d2.webp" alt="Workout Modes" class="feature-image">
                        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/d3.webp" alt="Battery Life" class="feature-image">
                        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/d4.webp" alt="Connectivity" class="feature-image">
                        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/d5.webp" alt="Water Resistant" class="feature-image">
                        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/d6.webp" alt="Customizable Design" class="feature-image">
                        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/d7.webp" alt="Customizable Design" class="feature-image">
                        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/d8.webp" alt="Water Resistant" class="feature-image">
                        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/d9.webp" alt="Customizable Design" class="feature-image">
                        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/d10.webp" alt="Customizable Design" class="feature-image">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Video Section -->
    <section class="video-section" id="videoSection">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="display-4 fw-bold">Video Produk TitanX-H11</h2>
                <p class="lead text-white">Tekan Play dan Lihat sendiri kehebatan jam tangan pintar ini</p>
            </div>
            <div class="video-container">
                <video id="productVideo" width="100%" height="100%" style="object-fit: cover;">
                    <source src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/v1.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
                <div class="video-overlay" id="videoOverlay">
                    <div class="play-button">
                        <i class="fas fa-play"></i>
                    </div>
                </div>
                <div class="video-controls">
                    <button class="video-control-btn" id="playPauseBtn" onclick="togglePlayPause()">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="video-control-btn" id="replayBtn" onclick="replayVideo()">
                        <i class="fas fa-redo"></i>
                    </button>
                    <button class="video-control-btn" id="muteBtn" onclick="toggleMute()">
                        <i class="fas fa-volume-up"></i>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section class="testimonials-section" id="testimonials">
        <div class="container">
            <div class="text-center mb-5">
                <h2 class="display-4 fw-bold text-white">Apa Kata Pelanggan Kami</h2>
                <p class="lead text-white">Sertai 500,000+ pengguna berpuas hati di seluruh dunia</p>
            </div>
            <div class="row">
                <div class="col-md-6 col-lg-4">
                    <div class="testimonial-card">
                        <div class="testimonial-stars">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <p class="testimonial-text">"First time beli jam online dan terus jatuh hati! Design memang lawa, connect ke phone pun senang. Bayar online selamat & cepat, seller pun responsif"</p>
                        <div class="testimonial-author">
                            <img src="https://picsum.photos/seed/user1/50/50.jpg" alt="User" class="author-avatar rounded-circle">
                            <div>
                                <h6 class="mb-0 text-white">Ahmad Razif</h6>
                                <small class="text-muted">Pembeli Disahkan</small>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="testimonial-card">
                        <div class="testimonial-stars">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <p class="testimonial-text">"Ini kali kedua saya beli sebab puas hati dengan kualiti. Seller cepat respon, barang original, dan online payment sangat mudah. Terbaik TitanX-H11 ni!"</p>
                        <div class="testimonial-author">
                            <img src="https://picsum.photos/seed/user2/50/50.jpg" alt="User" class="author-avatar rounded-circle">
                            <div>
                                <h6 class="mb-0 text-white">Nurhaliza</h6>
                                <small class="text-muted">Pembeli Disahkan</small>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="testimonial-card">
                        <div class="testimonial-stars">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <p class="testimonial-text">"Dah seminggu pakai, semua fungsi ok , heart rate, message alert, sleep tracking semua jalan."</p>
                        <div class="testimonial-author">
                            <img src="https://picsum.photos/seed/user3/50/50.jpg" alt="User" class="author-avatar rounded-circle">
                            <div>
                                <h6 class="mb-0 text-white">Mohd Danial</h6>
                                <small class="text-muted">Pembeli Disahkan</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

   <!-- WhatsApp Reviews Section -->
<section class="whatsapp-reviews-section">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-4 fw-bold text-white">Ulasan WhatsApp Pelanggan</h2>
            <p class="lead text-white">Lihat sendiri apa kata pelanggan kami</p>
        </div>
        <div class="whatsapp-reviews-container">
            <div class="whatsapp-reviews-wrapper">
                <button class="scroll-btn scroll-left" id="scrollLeft">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <div class="whatsapp-reviews-scroll">
                    <div class="whatsapp-review">
                        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/w1.webp" alt="WhatsApp Review 1">
                    </div>
                    <div class="whatsapp-review">
                        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/w2.webp" alt="WhatsApp Review 2">
                    </div>
                    <div class="whatsapp-review">
                        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/w3.webp" alt="WhatsApp Review 3">
                    </div>
                    <div class="whatsapp-review">
                        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/w4.webp" alt="WhatsApp Review 4">
                    </div>
                    <div class="whatsapp-review">
                        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/w5.webp" alt="WhatsApp Review 5">
                    </div>
                </div>
                <button class="scroll-btn scroll-right" id="scrollRight">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>
</section>

    <!-- Pricing Section -->
    <section class="pricing-section" id="pricing">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <div class="pricing-card text-center">
                        <div class="discount-badge">TAWARAN TERHAD</div>
                        <h2 class="display-5 fw-bold mb-4">TitanX-H11</h2>
                        <div class="mb-4">
                            <span class="original-price">RM189</span>
                            <div class="price-tag">RM89.90</div>
                            <p class="lead text-white">Jimat RM99.10 (52% OFF)</p>
                            <p class="text-success"><i class="fas fa-truck me-2"></i>Penghantaran Percuma</p>
                        </div>
                        
                        <!-- Color Variations -->
<div class="mb-4">
    <h5 class="text-white">Pilih Warna:</h5>
    <div class="color-option active mb-3" onclick="selectColor(0, 'black')">
        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/black.webp" alt="Black" class="w-100 d-block">
        <div class="color-label">Black</div>
    </div>
    <div class="color-option mb-3" onclick="selectColor(1, 'green')">
        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/green.webp" alt="Green" class="w-100 d-block">
        <div class="color-label">Green</div>
    </div>
    <div class="color-option sold-out mb-3" onclick="selectColor(2, 'brown')">
        <img src="https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/brown.webp" alt="Brown" class="w-100 d-block">
        <div class="color-label">Brown</div>
        <div class="sold-out-badge">HABIS</div>
    </div>
</div>
                        
                        <div class="mb-4">
                            <div class="d-flex justify-content-center align-items-center gap-3">
                                <button class="btn btn-outline-light" onclick="decreaseQuantity()">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span id="quantity" class="fs-4">1</span>
                                <button class="btn btn-outline-light" onclick="increaseQuantity()">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        <button class="btn btn-primary-custom btn-lg px-5 py-3" onclick="addToCart()">
                            <i class="fas fa-shopping-cart me-2"></i> Order Sekarang
                        </button>
                        
                        <div class="mt-4">
                            <small class="text-white">
                                <i class="fas fa-shield-alt me-2"></i> Jaminan Wang Kembali 30 Hari
                                <br>
                                <i class="fas fa-truck me-2"></i> Penghantaran Express Percuma Seluruh Malaysia
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Facts Section -->
    <section class="facts-section">
        <div class="container">
            <div class="fact-item">
                <div class="fact-header" onclick="toggleFact(this)">
                    <div class="fact-title">
                        <i class="fas fa-truck"></i> Penghantaran
                    </div>
                    <i class="fas fa-chevron-down fact-icon"></i>
                </div>
                <div class="fact-content">
                    <p>1 hingga 3 hari untuk semenanjung jika order online payment/bank transfer</p>
                    <p>Untuk cash on delivery 3 hingga 7 hari</p>
                </div>
            </div>
            
            <div class="fact-item">
                <div class="fact-header" onclick="toggleFact(this)">
                    <div class="fact-title">
                        <i class="fas fa-undo"></i> Free Return
                    </div>
                    <i class="fas fa-chevron-down fact-icon"></i>
                </div>
                <div class="fact-content">
                    <p>Kerosakkan dalam masa 7 hari setelah Smartwatch sampai</p>
                </div>
            </div>
            
            <div class="fact-item">
                <div class="fact-header" onclick="toggleFact(this)">
                    <div class="fact-title">
                        <i class="fas fa-shield-alt"></i> Warranty
                    </div>
                    <i class="fas fa-chevron-down fact-icon"></i>
                </div>
                <div class="fact-content">
                    <p>1 bulan warranty</p>
                </div>
            </div>
            
            <div class="fact-item">
                <div class="fact-header" onclick="toggleFact(this)">
                    <div class="fact-title">
                        <i class="fas fa-credit-card"></i> Pembayaran
                    </div>
                    <i class="fas fa-chevron-down fact-icon"></i>
                </div>
                <div class="fact-content">
                    <p>Pembayaran melalui online transfer di website</p>
                    <p>Untuk pembayaran melalui bank/qr sila buat order dan tekan whatsapp untuk sahkan pesanan</p>
                    <p>Pembayaran COD - Sampai baru bayar ada cas tambahan dari courier RM7</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Countdown Timer -->
    <section class="countdown-section">
        <div class="container">
            <h3 class="mb-3">⚡ Jualan Kilat Tamat Dalam:</h3>
            <div class="countdown-timer">
                <div class="countdown-item">
                    <div class="countdown-value" id="minutes">30</div>
                    <div class="countdown-label">Minit</div>
                </div>
                <div class="countdown-item">
                    <div class="countdown-value" id="seconds">00</div>
                    <div class="countdown-label">Saat</div>
                </div>
            </div>
        </div>
    </section>

    <!-- WhatsApp Button -->
    <div class="whatsapp-float">
        <div class="whatsapp-tooltip">Klik untuk order via WhatsApp</div>
        <a href="https://wa.me/601127412402?text=Saya%20nak%20order%20TitanX-H11%20guna%20qr/bank%20transfer" target="_blank">
            <button class="whatsapp-button">
                <i class="fab fa-whatsapp"></i>
            </button>
        </a>
    </div>

    <!-- Order Button -->
    <div class="order-float">
        <div class="order-tooltip">Order sekarang & Jimat RM99.10</div>
        <button class="order-button" onclick="scrollToPricing()">
            <i class="fas fa-shopping-cart me-2"></i> Order - Jimat RM99.10
        </button>
    </div>


    <!-- Cart Sidebar -->
    <div class="cart-overlay" onclick="toggleCart()"></div>
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h5><i class="fas fa-shopping-cart me-2"></i> Troli Beli-belah</h5>
            <button class="btn btn-sm btn-outline-light" onclick="toggleCart()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="cart-body" id="cartBody">
            <p class="text-center text-white">Troli anda kosong</p>
        </div>
        <div class="cart-footer">
            <div class="discount-info" id="discount-info">
                <p><strong>Diskaun:</strong></p>
                <div class="price-breakdown original">
                    <span>Harga Asal:</span>
                    <span id="original-price">RM0</span>
                </div>
                <div class="price-breakdown discount">
                    <span>Jumlah Diskaun:</span>
                    <span id="discounted-price">-RM0</span>
                </div>
                <p>Jimat <span id="savings-amount">RM0</span>!</p>
            </div>
            <div class="d-flex justify-content-between mb-3">
                <span class="text-white">Jumlah:</span>
                <span class="fw-bold text-white" id="cartTotal">RM0</span>
            </div>
            <div class="d-flex justify-content-between mb-3">
                <span class="text-white">Harga Asal:</span>
                <span class="text-white" id="cartOriginalPrice">RM0</span>
            </div>
            <div class="d-flex justify-content-between mb-3">
                <span class="text-white">Jimat:</span>
                <span class="text-success fw-bold" id="cartSavings">RM0</span>
            </div>
            <button class="btn btn-primary-custom w-100" onclick="openCheckout()">
                <i class="fas fa-credit-card me-2"></i> Checkout
            </button>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div class="checkout-modal" id="checkoutModal">
        <div class="checkout-content">
            <button class="close-modal" onclick="closeCheckout()">
                <i class="fas fa-times"></i>
            </button>
            <h3 class="mb-4">Maklumat Penghantaran</h3>
            
            <div class="success-message" id="successMessage">
                <i class="fas fa-check-circle me-2"></i> Pesanan anda telah diterima!
            </div>
            
            <form id="checkoutForm">
                <div class="form-group">
                    <label class="form-label text-white">Nama</label>
                    <input type="text" class="form-control" id="customerName" placeholder="Contoh: Ahmad bin Ismail">
                    <div class="error-message" id="nameError">Sila masukkan nama anda</div>
                </div>
                
                <div class="form-group">
                    <label class="form-label text-white">No Telephone (WhatsApp)</label>
                    <input type="tel" class="form-control" id="customerPhone" placeholder="Contoh: 0123456789">
                    <div class="error-message" id="phoneError">Sila masukkan nombor telefon yang sah (10-11 digit)</div>
                </div>
                
                <div class="form-group">
                    <label class="form-label text-white">Alamat</label>
                    <input type="text" class="form-control" id="customerAddress" placeholder="Contoh: No 123, Jalan ABC, Taman XYZ">
                    <div class="error-message" id="addressError">Sila masukkan alamat penghantaran yang lengkap</div>
                </div>
                
                <div class="form-group">
                    <label class="form-label text-white">Poskod</label>
                    <input type="text" class="form-control" id="customerPostcode" placeholder="Contoh: 12345">
                    <div class="error-message" id="postcodeError">Sila masukkan poskod yang sah (5 digit)</div>
                </div>
                
                <div class="form-group">
                    <label class="form-label text-white">Negeri</label>
                    <select class="form-control" id="customerState">
                        <option value="">Pilih negeri</option>
                        <option value="johor">Johor</option>
                        <option value="kedah">Kedah</option>
                        <option value="kelantan">Kelantan</option>
                        <option value="melaka">Melaka</option>
                        <option value="negeri-sembilan">Negeri Sembilan</option>
                        <option value="pahang">Pahang</option>
                        <option value="perak">Perak</option>
                        <option value="perlis">Perlis</option>
                        <option value="pulau-pinang">Pulau Pinang</option>
                        <option value="sabah">Sabah</option>
                        <option value="sarawak">Sarawak</option>
                        <option value="selangor">Selangor</option>
                        <option value="terengganu">Terengganu</option>
                        <option value="kuala-lumpur">Kuala Lumpur</option>
                        <option value="labuan">Labuan</option>
                        <option value="putrajaya">Putrajaya</option>
                    </select>
                    <div class="error-message" id="stateError">Sila pilih negeri</div>
                </div>
                
                <div class="form-group">
                    <label class="form-label text-white">Cara Pembayaran</label>
                    <div class="payment-option" onclick="selectPayment('online')">
                        <input type="radio" name="payment" value="online" id="onlinePayment" checked>
                        <label for="onlinePayment">Pembayaran Online</label>
                    </div>
                    <div class="payment-option" onclick="selectPayment('cod')">
                        <input type="radio" name="payment" value="cod" id="codPayment">
                        <label for="codPayment">Bayar pada Courier (COD) - Cas tambahan RM7 (Tidak tersedia untuk Sabah & Sarawak)</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="confirmInfo">
                        <label class="form-check-label text-white" for="confirmInfo">
                            Saya mengesahkan maklumat di atas adalah betul
                        </label>
                    </div>
                    <div class="error-message" id="confirmError">Sila tick untuk mengesahkan maklumat</div>
                </div>
                
                <button type="button" class="btn btn-primary-custom w-100" onclick="submitOrder()">
                    <i class="fas fa-shopping-cart me-2"></i> Hantar Pesanan
                </button>
            </form>
            
            <a href="#" class="whatsapp-confirm" id="whatsappConfirm" style="display: none;" target="_blank">
                <i class="fab fa-whatsapp me-2"></i> Sahkan Pesanan di WhatsApp
            </a>
        </div>
    </div>

    <!-- Order Confirmation Modal -->
    <div class="order-confirmation-modal" id="orderConfirmationModal">
        <div class="order-confirmation-content">
            <button class="close-confirmation" onclick="closeOrderConfirmation()">
                <i class="fas fa-times"></i>
            </button>
            <div class="order-success-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h2 class="order-confirmation-title">Pesanan Anda Berjaya!</h2>
            <p class="order-confirmation-message">
                Terima kasih kerana membeli dari HASRASTORE! Pesanan anda telah diterima dan akan diproses segera.
            </p>
            
            <div class="order-details">
                <div class="order-detail-row">
                    <span class="order-detail-label">Order ID:</span>
                    <span class="order-detail-value" id="orderId">#TX0000</span>
                </div>
                <div class="order-detail-row">
                    <span class="order-detail-label">Produk:</span>
                    <span class="order-detail-value" id="orderProduct">TitanX-H11</span>
                </div>
                <div class="order-detail-row">
                    <span class="order-detail-label">Kuantiti:</span>
                    <span class="order-detail-value" id="orderQuantity">1</span>
                </div>
                <div class="order-detail-row">
                    <span class="order-detail-label">Jumlah Bayaran:</span>
                    <span class="order-detail-value" id="orderTotal">RM89.90</span>
                </div>
                <div class="order-detail-row order-total-row">
                    <span class="order-detail-label">Jumlah Bayaran kepada Posmen:</span>
                    <span class="order-total-value" id="orderCodTotal">RM96.90</span>
                </div>
            </div>
            
            <p class="order-confirmation-message">
                <strong>Penting:</strong> Sila klik butang WhatsApp di bawah untuk mengesahkan pesanan anda. Ini akan mempercepatkan proses penghantaran!
            </p>
            
            <a href="#" class="whatsapp-cta" id="whatsappCta" target="_blank" rel="noopener noreferrer">
                <i class="fab fa-whatsapp"></i>
                <span>Klik WhatsApp untuk Sahkan Pesanan</span>
            </a>
        </div>
    </div>
    
    <!-- Online Payment Confirmation Modal -->
    <div class="online-payment-confirmation-modal" id="onlinePaymentConfirmationModal">
        <div class="online-payment-confirmation-content">
            <button class="close-online-payment-confirmation" onclick="closeOnlinePaymentConfirmation()">
                <i class="fas fa-times"></i>
            </button>
            <div class="online-payment-success-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h2 class="online-payment-confirmation-title">Pesanan diterima, sila buat pembayaran</h2>
            <p class="online-payment-confirmation-message">
                Terima kasih kerana membeli dari HASRASTORE! Pesanan anda telah diterima. Sila klik butang di bawah untuk membuat pembayaran sebelum voucher tamat.
            </p>
            
            <div class="online-payment-details">
                <div class="online-payment-detail-row">
                    <span class="online-payment-detail-label">Order ID:</span>
                    <span class="online-payment-detail-value" id="onlineOrderId">#TX0000</span>
                </div>
                <div class="online-payment-detail-row">
                    <span class="online-payment-detail-label">Produk:</span>
                    <span class="online-payment-detail-value" id="onlineOrderProduct">TitanX-H11</span>
                </div>
                <div class="online-payment-detail-row">
                    <span class="online-payment-detail-label">Kuantiti:</span>
                    <span class="online-payment-detail-value" id="onlineOrderQuantity">1</span>
                </div>
                <div class="online-payment-detail-row">
                    <span class="online-payment-detail-label">Jumlah Bayaran:</span>
                    <span class="online-payment-detail-value" id="onlineOrderTotal">RM89.90</span>
                </div>
            </div>
            
            <p class="online-payment-confirmation-message">
                <strong>Penting:</strong> Sila tekan butang di atas untuk buat pembayaran sebelum voucher tamat.
            </p>
            
            <button class="online-payment-cta" id="onlinePaymentCta" onclick="redirectToPayment()">
                <i class="fas fa-credit-card"></i>
                <span>Klik untuk Pembayaran Online</span>
            </button>
        </div>
    </div>

    <!-- Footer -->
    <footer style="background: var(--bg-card); padding: 50px 0 20px;">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-4">
                    <h5 class="mb-3">HASRASTORE</h5>
                    <p>Jam tangan pintar generasi terbaru untuk gaya hidup moden.</p>
                    <div class="mt-3">
                        <a href="#" class="text-light me-3"><i class="fab fa-facebook fa-lg"></i></a>
                        <a href="#" class="text-light me-3"><i class="fab fa-instagram fa-lg"></i></a>
                        <a href="#" class="text-light"><i class="fab fa-tiktok fa-lg"></i></a>
                    </div>
                </div>
                <div class="col-md-4 mb-4">
                    <h5 class="mb-3">Hubungi</h5>
                    <p><i class="fas fa-envelope me-2"></i> support@hasrastore.my</p>
                    <p><i class="fas fa-phone me-2"></i> +6011-27412402</p>
                </div>
                <div class="col-md-4 mb-4">
                    <h5 class="mb-3">Maklumat</h5>
                    <p><i class="fas fa-map-marker-alt me-2"></i> Kuala Lumpur, Malaysia</p>
                    <p><i class="fas fa-clock me-2"></i> Isnin - Jumaat: 9AM - 6PM</p>
                </div>
            </div>
            <hr style="border-color: var(--bg-hover);">
            <div class="text-center">
                <p class="mb-0 text-muted">&copy; 2024 HASRASTORE. Hak cipta terpelihara.</p>
            </div>
        </div>
    </footer>

    <!-- Voucher Popup -->
    <div class="voucher-popup" id="voucher-popup">
        <div class="voucher-content">
            <button class="voucher-close" id="voucher-close">&times;</button>
            <div class="voucher-icon">
                <i class="fas fa-gift"></i>
            </div>
            <h2 class="voucher-title">Tahniah! Anda Dapat Voucher</h2>
            <div class="voucher-amount">RM99.10 Off</div>
            <p class="voucher-description">Voucher ini sah selama 15 minit sahaja. Sila gunakan segera untuk pembelian anda!</p>
            <div class="voucher-timer" id="voucher-timer">
                <div class="timer-unit">
                    <span class="timer-value" id="voucher-minutes">15</span>
                    <span class="timer-label">Minutes</span>
                </div>
                <div class="timer-unit">
                    <span class="timer-value" id="voucher-seconds">00</span>
                    <span class="timer-label">Seconds</span>
                </div>
            </div>
            <button class="voucher-claim-btn" id="voucher-claim-btn">Claim</button>
        </div>
    </div>
    
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">Memproses tempahan anda...</div>
            <div class="loading-subtext">Sila tunggu sebentar, jangan tutup halaman ini</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>
    
    <!-- Payment Loading Modal -->
    <div id="paymentLoadingModal" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">Menghubungkan ke sistem pembayaran...</div>
            <div class="loading-subtext">Sila tunggu, anda akan diarahkan ke halaman pembayaran dalam masa terdekat</div>
            <div class="loading-progress">
                <div class="loading-progress-bar"></div>
            </div>
        </div>
    </div>
    
    <!-- Payment Redirect Modal -->
    <div id="paymentRedirectModal" class="payment-redirect-modal">
        <div class="payment-redirect-modal-content">
            <i class="fas fa-credit-card text-primary text-5xl mb-4"></i>
            <h3 class="text-2xl font-bold mb-2">Pembayaran Dalam Talian</h3>
            <p class="mb-6">Klik butang di bawah untuk meneruskan ke pembayaran.</p>
            <button id="manualRedirectBtn" class="btn btn-primary px-6 py-2 rounded-lg font-bold hover:bg-primary-600 transition mb-4">
                Teruskan Pembayaran
            </button>
            <div class="flex items-center justify-center mt-4">
                <p class="text-sm text-gray-600 mr-2">Jika butang tidak berfungsi, cuba lagi atau hubungi kami melalui WhatsApp:</p>
                <a href="https://wa.me/601127412402?text=Hi,%20saya%20nak%20tanya%20pasang%20jam%20TitanX-H11" target="_blank" class="text-green-500 hover:text-green-600">
                    <i class="fab fa-whatsapp text-2xl"></i>
                </a>
            </div>
        </div>
    </div>
    
    <!-- Notification Container -->
    <div class="notification-container" id="notification-container"></div>
    
    <!-- Notification Sound -->
    <audio id="notificationSound" preload="auto">
        <source src="https://www.freesfx.co.uk/sound/16297_1460570779.mp3" type="audio/mp3">
        Your browser does not support the audio element.
    </audio>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
    <script>
        // ====================================
        //      CONFIGURATION
        // ====================================
        const TELEGRAM_CONFIG = {
            botToken: '8390631438:AAGUletc8b6kFztiuysYOWHlvYTj4tXNwy4',
            chatId: '642142575'
        };
        
        const TOYYIBPAY_CONFIG = {
            userSecretKey: 'b2kcp05o-b5m0-q000-55i7-w3j57riufv7h',
            categoryCode: 'ltigdivv',
            callbackUrl: 'https://hasratitanx.vercel.app/payment-callback.html',
            returnUrl: 'https://hasratitanx.vercel.app/payment-successful.html',
            failedUrl: 'https://hasratitanx.vercel.app/payment-failed.html'
        };
        
        // Voucher configuration
        const VOUCHER_DISCOUNT = 99.10; // RM99.10 voucher discount (189 - 89.90)
        const ORIGINAL_PRICE = 189.00; // RM189.00 original price
        
        // Cart Management
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let totalSales = 0;
        let stockLeft = 23;
        let buyersToday = 27;
        let selectedColorIndex = 0;
        let selectedColorName = 'black';
        const originalPrice = 189.00;
        const salesPrice = 89.90; // Updated to RM89.90
        const codFee = 7.00;
        const colorPrices = {
            'black': salesPrice,
            'green': salesPrice,
            'brown': salesPrice
        };

        // Performance Optimizations
        document.addEventListener('DOMContentLoaded', function() {
            // Add lazy loading for images
            const images = document.querySelectorAll('img');
            images.forEach(img => {
                img.loading = 'lazy';
            });
            
            // Optimize font loading
            const fontLink = document.createElement('link');
            fontLink.rel = 'stylesheet';
            fontLink.href = 'https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap';
            document.head.appendChild(fontLink);
        });

        // Debounce function for scroll events
        function debounce(func, wait) {
            let timeout;
            return function() {
                const context = this;
                const args = arguments;
                clearTimeout(timeout);
                timeout = setTimeout(() => {
                    func.apply(context, args);
                }, wait);
            };
        }

        // Initialize WhatsApp Reviews Carousel
        $(document).ready(function(){
            $('.whatsapp-reviews-carousel').slick({
                slidesToShow: 3,
                slidesToScroll: 1,
                autoplay: true,
                autoplaySpeed: 3000,
                dots: true,
                arrows: true,
                responsive: [
                    {
                        breakpoint: 768,
                        settings: {
                            slidesToShow: 1,
                            slidesToScroll: 1
                        }
                    }
                ]
            });
        });

        // Auto-scroll functionality for WhatsApp reviews
        function initWhatsAppReviewsScroll() {
            const reviewsScroll = document.querySelector('.whatsapp-reviews-scroll');
            if (!reviewsScroll) return;
            
            // Clone the items for seamless scrolling
            const reviews = Array.from(reviewsScroll.children);
            reviews.forEach(review => {
                const clone = review.cloneNode(true);
                reviewsScroll.appendChild(clone);
            });
            
            let scrollAmount = 0;
            let scrollSpeed = 1; // pixels per frame
            let isPaused = false;
            
            // Auto-scroll function
            function autoScroll() {
                if (!isPaused) {
                    scrollAmount += scrollSpeed;
                    
                    // Reset scroll position when reaching the end
                    if (scrollAmount >= reviewsScroll.scrollWidth / 2) {
                        scrollAmount = 0;
                    }
                    
                    reviewsScroll.scrollLeft = scrollAmount;
                }
                requestAnimationFrame(autoScroll);
            }
            
            // Start auto-scroll
            autoScroll();
            
            // Pause on hover
            reviewsScroll.addEventListener('mouseenter', () => {
                isPaused = true;
            });
            
            reviewsScroll.addEventListener('mouseleave', () => {
                isPaused = false;
            });
            
            // Pause on touch
            reviewsScroll.addEventListener('touchstart', () => {
                isPaused = true;
            });
            
            reviewsScroll.addEventListener('touchend', () => {
                setTimeout(() => {
                    isPaused = false;
                }, 3000); // Resume after 3 seconds
            });
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            initWhatsAppReviewsScroll();
        });

        // Video Section Functions
        function showVideo() {
            const videoSection = document.getElementById('videoSection');
            videoSection.scrollIntoView({ behavior: 'smooth' });
        }

        // Video control functions
        function togglePlayPause() {
            const video = document.getElementById('productVideo');
            const overlay = document.getElementById('videoOverlay');
            const playPauseBtn = document.getElementById('playPauseBtn');
            const icon = playPauseBtn.querySelector('i');
            
            if (video.paused) {
                video.play();
                overlay.style.display = 'none';
                icon.classList.remove('fa-play');
                icon.classList.add('fa-pause');
            } else {
                video.pause();
                overlay.style.display = 'flex';
                icon.classList.remove('fa-pause');
                icon.classList.add('fa-play');
            }
        }

        function replayVideo() {
            const video = document.getElementById('productVideo');
            video.currentTime = 0;
            video.play();
            document.getElementById('videoOverlay').style.display = 'none';
            
            const playPauseBtn = document.getElementById('playPauseBtn');
            const icon = playPauseBtn.querySelector('i');
            icon.classList.remove('fa-play');
            icon.classList.add('fa-pause');
        }

        function toggleMute() {
            const video = document.getElementById('productVideo');
            const muteBtn = document.getElementById('muteBtn');
            const icon = muteBtn.querySelector('i');
            
            video.muted = !video.muted;
            
            if (video.muted) {
                icon.classList.remove('fa-volume-up');
                icon.classList.add('fa-volume-mute');
            } else {
                icon.classList.remove('fa-volume-mute');
                icon.classList.add('fa-volume-up');
            }
        }

        // Update video overlay click event
        document.getElementById('videoOverlay').addEventListener('click', function() {
            togglePlayPause();
        });

        // Update video ended event
        document.getElementById('productVideo').addEventListener('ended', function() {
            document.getElementById('videoOverlay').style.display = 'flex';
            
            const playPauseBtn = document.getElementById('playPauseBtn');
            const icon = playPauseBtn.querySelector('i');
            icon.classList.remove('fa-pause');
            icon.classList.add('fa-play');
        });

        // Countdown Timer (30 minutes)
        function startCountdown() {
            let minutes = 30;
            let seconds = 0;

            setInterval(() => {
                seconds--;
                if (seconds < 0) {
                    seconds = 59;
                    minutes--;
                    if (minutes < 0) {
                        minutes = 30; // Reset to 30 minutes when it reaches 0
                    }
                }

                document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
                document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
            }, 1000);
        }

        // Color Selection
        function selectColor(index, colorName) {
            const colorOptions = document.querySelectorAll('.color-option');
            
            // Check if the selected color is sold out
            if (colorOptions[index].classList.contains('sold-out')) {
                showNotification('Warna ini sudah habis stok!', 'error');
                return;
            }
            
            // Remove active class from all options
            colorOptions.forEach(option => option.classList.remove('active'));
            
            // Add active class to selected option
            colorOptions[index].classList.add('active');
            
            // Update selected color
            selectedColorIndex = index;
            selectedColorName = colorName;
        }

        // Quantity Selector
        let quantity = 1;
        function increaseQuantity() {
            if (quantity < stockLeft) {
                quantity++;
                document.getElementById('quantity').textContent = quantity;
            }
        }
        function decreaseQuantity() {
            if (quantity > 1) {
                quantity--;
                document.getElementById('quantity').textContent = quantity;
            }
        }

        // Add to Cart
        function addToCart() {
            const item = {
                name: 'TitanX-H11',
                originalPrice: originalPrice,
                price: colorPrices[selectedColorName],
                quantity: quantity,
                color: selectedColorName,
                image: `https://cdn.jsdelivr.net/gh/hasrastore-ops/titanmedia@v1.0/${selectedColorName}.webp`
            };
            
            cart.push(item);
            updateCart();
            
            // Update stock and buyers
            stockLeft -= quantity;
            buyersToday += quantity;
            totalSales += (item.price * quantity);
            
            document.getElementById('stockLeft').textContent = stockLeft;
            document.getElementById('buyersToday').textContent = buyersToday.toLocaleString();
            
            // Track AddToCart event
            trackAddToCart(quantity);
            
            // Show success message
            showNotification('Pesanan anda telah diterima!');
            
            // Open cart
            setTimeout(() => {
                toggleCart();
            }, 500);
        }

        // Update Cart Display
        function updateCart() {
            const cartBody = document.getElementById('cartBody');
            const cartBadge = document.getElementById('cartBadge');
            const cartTotal = document.getElementById('cartTotal');
            const cartOriginalPrice = document.getElementById('cartOriginalPrice');
            const cartSavings = document.getElementById('cartSavings');
            const discountInfo = document.getElementById('discount-info');
            const originalPriceElement = document.getElementById('original-price');
            const discountedPriceElement = document.getElementById('discounted-price');
            const savingsAmountElement = document.getElementById('savings-amount');
            
            if (cart.length === 0) {
                cartBody.innerHTML = '<p class="text-center text-white">Troli anda kosong</p>';
                cartBadge.textContent = '0';
                cartTotal.textContent = 'RM0';
                cartOriginalPrice.textContent = 'RM0';
                cartSavings.textContent = 'RM0';
                discountInfo.classList.remove('show');
            } else {
                const voucherClaimed = localStorage.getItem('voucherClaimed') === 'true';
                const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                
                // Calculate totals with discount
                let totalOriginal = totalItems * ORIGINAL_PRICE;
                let totalDiscount = 0;
                let totalFinal = 0;
                let discountMessage = '';
                let discountNote = '';
                let savingsMessage = '';
                
                // Apply bundle discount for 2 or more items (highest priority)
                if (totalItems >= 2) {
                    totalFinal = totalItems * 79.90; // Bundle price per item
                    totalDiscount = totalOriginal - totalFinal;
                    discountMessage = 'Bundle Offer (2+ Items):';
                    discountNote = `<p>Bundle Price: RM79.90 per unit | Free Shipping</p>`;
                    savingsMessage = `<p class="savings-message">Jimat RM${(ORIGINAL_PRICE - 79.90).toFixed(2)} per unit!</p>`;
                } 
                // Apply voucher discount if no bundle
                else if (voucherClaimed) {
                    totalDiscount = totalItems * VOUCHER_DISCOUNT;
                    totalFinal = totalOriginal - totalDiscount;
                    discountMessage = 'Voucher Applied:';
                    discountNote = `<p class="voucher-note">Voucher Applied: *terhad 19 orang terawal RM${VOUCHER_DISCOUNT.toFixed(2)}</p>`;
                    savingsMessage = `<p class="savings-message">Tahniah anda mendapat harga istimewa</p>`;
                } 
                // Apply single item discount
                else {
                    totalFinal = totalItems * 89.90; // Updated to RM89.90
                    totalDiscount = totalOriginal - totalFinal;
                    discountMessage = 'Harga Promosi:';
                    discountNote = `<p>Special Price: RM89.90 per unit</p>`;
                    savingsMessage = `<p class="savings-message">Jimat RM${(ORIGINAL_PRICE - 89.90).toFixed(2)} per unit!</p>`;
                }
                
                // Update cart items display
                cartBody.innerHTML = cart.map((item, index) => {
                    const itemOriginal = ORIGINAL_PRICE;
                    let itemFinal = 0;
                    let itemDiscountNote = '';
                    
                    if (totalItems >= 2) {
                        itemFinal = 79.90;
                        itemDiscountNote = `<p>Bundle Price: RM79.90</p>`;
                    } else if (voucherClaimed) {
                        itemFinal = ORIGINAL_PRICE - VOUCHER_DISCOUNT;
                        itemDiscountNote = `<p class="voucher-note">Voucher Applied: RM${VOUCHER_DISCOUNT.toFixed(2)}</p>`;
                    } else {
                        itemFinal = 89.90; // Updated to RM89.90
                        itemDiscountNote = `<p>Special Price: RM89.90</p>`;
                    }
                    
                    const colorName = item.color === 'black' ? 'Hitam' : 
                                     item.color === 'green' ? 'Hijau green' : 'Coklat';
                    
                    return `
                        <div class="cart-item">
                            <img src="${item.image}" alt="${item.name}" style="width: 120px; height: 210px; border-radius: 10px;">
                            <div class="flex-grow-1">
                                <h6 class="mb-1 text-white">${item.name}</h6>
                                <small class="text-muted">${colorName} x ${item.quantity}</small>
                                <p>Harga Asal: RM${itemOriginal.toFixed(2)}</p>
                                ${itemDiscountNote}
                                <p><strong>Harga Akhir: RM${itemFinal.toFixed(2)}</strong></p>
                                ${savingsMessage}
                            </div>
                            <div class="text-end">
                                <button class="btn btn-sm btn-outline-danger mt-1" onclick="removeFromCart(${index})">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
                
                // Always show discount info box for non-empty cart
                discountInfo.classList.add('show');
                originalPriceElement.textContent = `RM${totalOriginal.toFixed(2)}`;
                discountedPriceElement.textContent = `-RM${totalDiscount.toFixed(2)}`;
                savingsAmountElement.textContent = `RM${totalDiscount.toFixed(2)}`;
                
                // Update discount message
                const discountMessageElement = discountInfo.querySelector('p strong');
                discountMessageElement.textContent = discountMessage;
                
                cartBadge.textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
                cartTotal.textContent = 'RM' + totalFinal.toFixed(2);
                cartOriginalPrice.textContent = 'RM' + totalOriginal.toFixed(2);
                cartSavings.textContent = 'RM' + totalDiscount.toFixed(2);
            }
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        // Remove from Cart
        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCart();
        }

        // Toggle Cart
        function toggleCart() {
            const cartSidebar = document.getElementById('cartSidebar');
            const cartOverlay = document.querySelector('.cart-overlay');
            
            cartSidebar.classList.toggle('active');
            cartOverlay.classList.toggle('active');
        }

        // Open Checkout Modal
        function openCheckout() {
            if (cart.length === 0) {
                showNotification('Troli anda kosong!', 'error');
                return;
            }
            
            const checkoutModal = document.getElementById('checkoutModal');
            checkoutModal.classList.add('active');
            toggleCart();
        }

        // Close Checkout Modal
        function closeCheckout() {
            const checkoutModal = document.getElementById('checkoutModal');
            checkoutModal.classList.remove('active');
        }

        // Close Order Confirmation Modal
        function closeOrderConfirmation() {
            const modal = document.getElementById('orderConfirmationModal');
            modal.classList.remove('active');
        }
        
        // Close Online Payment Confirmation Modal
        function closeOnlinePaymentConfirmation() {
            const modal = document.getElementById('onlinePaymentConfirmationModal');
            modal.classList.remove('active');
        }

        // Select Payment Method
        function selectPayment(method) {
            document.getElementById(method + 'Payment').checked = true;
            
            // Check if COD is selected and state is Sabah or Sarawak
            if (method === 'cod') {
                const state = document.getElementById('customerState').value;
                if (state === 'sabah' || state === 'sarawak') {
                    showNotification('COD tidak tersedia untuk Sabah & Sarawak', 'error');
                    document.getElementById('onlinePayment').checked = true;
                }
            }
        }

        // Submit Order
        async function submitOrder() {
            // Reset error messages
            document.querySelectorAll('.error-message').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.form-control').forEach(el => el.classList.remove('error'));
            
            let isValid = true;
            
            // Validate name
            const name = document.getElementById('customerName').value.trim();
            if (!name) {
                document.getElementById('nameError').style.display = 'block';
                document.getElementById('customerName').classList.add('error');
                isValid = false;
            }
            
            // Validate phone
            const phone = document.getElementById('customerPhone').value.trim();
            const phoneRegex = /^0\d{9,10}$/;
            if (!phoneRegex.test(phone)) {
                document.getElementById('phoneError').style.display = 'block';
                document.getElementById('customerPhone').classList.add('error');
                isValid = false;
            }
            
            // Validate address
            const address = document.getElementById('customerAddress').value.trim();
            if (!address) {
                document.getElementById('addressError').style.display = 'block';
                document.getElementById('customerAddress').classList.add('error');
                isValid = false;
            }
            
            // Validate postcode
            const postcode = document.getElementById('customerPostcode').value.trim();
            const postcodeRegex = /^\d{5}$/;
            if (!postcodeRegex.test(postcode)) {
                document.getElementById('postcodeError').style.display = 'block';
                document.getElementById('customerPostcode').classList.add('error');
                isValid = false;
            }
            
            // Validate state
            const state = document.getElementById('customerState').value;
            if (!state) {
                document.getElementById('stateError').style.display = 'block';
                document.getElementById('customerState').classList.add('error');
                isValid = false;
            }
            
            // Check if COD is selected and state is Sabah or Sarawak
            const paymentMethod = document.querySelector('input[name="payment"]:checked').value;
            if (paymentMethod === 'cod' && (state === 'sabah' || state === 'sarawak')) {
                showNotification('COD tidak tersedia untuk Sabah & Sarawak', 'error');
                isValid = false;
            }
            
            // Validate confirmation
            const confirmInfo = document.getElementById('confirmInfo').checked;
            if (!confirmInfo) {
                document.getElementById('confirmError').style.display = 'block';
                isValid = false;
            }
            
            if (!isValid) {
                return;
            }
            
            // Show loading overlay
            showLoading();
            
            // Calculate total
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            let totalAmount = 0;
            
            // Apply bundle pricing for 2 or more items
            if (totalItems >= 2) {
                totalAmount = totalItems * 79.90; // Bundle price per item
            } else {
                // Single item pricing
                const voucherClaimed = localStorage.getItem('voucherClaimed') === 'true';
                if (voucherClaimed) {
                    totalAmount = totalItems * (ORIGINAL_PRICE - VOUCHER_DISCOUNT);
                } else {
                    totalAmount = totalItems * 89.90; // Updated to RM89.90
                }
            }
            
            // Add COD fee if applicable (only for single items)
            let codAmount = totalAmount;
            if (paymentMethod === 'cod') {
                codAmount += 7.00; // RM7 courier fee
            }
            
            // Track InitiateCheckout event
            trackInitiateCheckout(totalItems, totalAmount);
            
            // Prepare order data for Telegram and Discord
            const productNames = cart.map(item => {
                const colorName = item.color === 'black' ? 'Hitam' : 
                                 item.color === 'green' ? 'Hijau green' : 'Coklat';
                return `TitanX-H11 ${colorName}`;
            }).join(', ');
            
            const orderData = {
                product: productNames,
                quantity: totalItems,
                total: totalAmount,
                codTotal: codAmount,
                paymentMethod: paymentMethod === 'online' ? 'Online Payment' : 'COD',
                customerName: name,
                customerPhone: phone,
                customerAddress: address,
                poskod: postcode,
                customerState: state,
                paymentStatus: paymentMethod === 'online' ? 'Pending' : 'Pending'
            };
            
            try {
                // Simulate a delay to show loading for at least 2 seconds
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Send notifications to both Telegram and Discord
                const telegramResult = await sendTelegramNotification(orderData);
                const discordResult = await sendDiscordNotification(orderData);
                
                if (!telegramResult) {
                    console.error('Failed to send Telegram notification');
                }
                
                if (!discordResult) {
                    console.error('Failed to send Discord notification');
                }
                
                // Hide loading overlay
                hideLoading();
                
                // Close checkout modal
                closeCheckout();
                
                // Show appropriate confirmation modal based on payment method
                if (paymentMethod === 'online') {
                    showOnlinePaymentConfirmation(orderData);
                } else {
                    showOrderConfirmation(orderData);
                }
                
                // Clear cart after successful order
                cart = [];
                updateCart();
                
            } catch (error) {
                console.error('Error processing order:', error);
                hideLoading();
                showNotification('Ralat semasa memproses tempahan. Sila cuba lagi.', 'error');
            }
        }

        // Show Order Confirmation Modal
        function showOrderConfirmation(orderData) {
            const modal = document.getElementById('orderConfirmationModal');
            
            // Generate order ID
            const orderId = `#TX${Math.floor(1000 + Math.random() * 9000)}`;
            document.getElementById('orderId').textContent = orderId;
            
            // Update order details
            document.getElementById('orderProduct').textContent = orderData.product;
            document.getElementById('orderQuantity').textContent = orderData.quantity;
            document.getElementById('orderTotal').textContent = `RM${orderData.total.toFixed(2)}`;
            document.getElementById('orderCodTotal').textContent = `RM${orderData.codTotal.toFixed(2)}`;
            
            // Track Purchase event for COD with courier fee included
            trackPurchase(orderData.quantity, orderData.codTotal); // Use codTotal instead of total
            
            // Generate WhatsApp URL and set it to the button
            const whatsappURL = generateWhatsAppURL(orderData, orderId);
            const whatsappCta = document.getElementById('whatsappCta');
            
            // Set the href attribute
            whatsappCta.setAttribute('href', whatsappURL);
            
            // Make sure the button is visible
            whatsappCta.style.display = 'inline-flex';
            
            // Show modal
            modal.classList.add('active');
        }
        
        // Show Online Payment Confirmation Modal
        function showOnlinePaymentConfirmation(orderData) {
            const modal = document.getElementById('onlinePaymentConfirmationModal');
            
            // Generate order ID
            const orderId = `#TX${Math.floor(1000 + Math.random() * 9000)}`;
            document.getElementById('onlineOrderId').textContent = orderId;
            
            // Update order details
            document.getElementById('onlineOrderProduct').textContent = orderData.product;
            document.getElementById('onlineOrderQuantity').textContent = orderData.quantity;
            document.getElementById('onlineOrderTotal').textContent = `RM${orderData.total.toFixed(2)}`;
            
            // Store order data for payment processing
            localStorage.setItem('pendingOrder', JSON.stringify(orderData));
            
            // Show modal
            modal.classList.add('active');
        }
        
        // Redirect to Payment
        async function redirectToPayment() {
            const orderData = JSON.parse(localStorage.getItem('pendingOrder'));
            
            if (!orderData) {
                showNotification('Ralat: Maklumat pesanan tidak dijumpai. Sila cuba lagi.', 'error');
                return;
            }
            
            // Show payment loading modal
            showPaymentLoading();
            
            // Close the confirmation modal
            closeOnlinePaymentConfirmation();
            
            try {
                // Redirect to ToyyibPay
                const success = await redirectToToyyibPay(orderData);
                
                if (!success) {
                    hidePaymentLoading();
                    showNotification('Ralat semasa menghubungkan ke sistem pembayaran. Sila cuba lagi.', 'error');
                }
            } catch (error) {
                console.error('Error redirecting to payment:', error);
                hidePaymentLoading();
                showNotification('Ralat semasa menghubungkan ke sistem pembayaran. Sila cuba lagi.', 'error');
            }
        }

        // ====================================
        //      TELEGRAM NOTIFICATION
        // ====================================
        async function sendTelegramNotification(orderData) {
            const paymentStatusText = orderData.paymentStatus === 'Paid' ? 
                '✅ <b>TELAH DIBAYAR</b>' : 
                '⏳ <b>MENUNGGU PEMBAYARAN</b>';
                
            // Format the date and time
            const orderDateTime = new Date().toLocaleString('ms-MY', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // Use codTotal for COD orders, total for online payment
            const amount = orderData.paymentMethod === 'COD' ? orderData.codTotal : orderData.total;
                
            const message = `
🆕 <b>PESANAN BARU HASRASTORE</b> 🆕
 ${paymentStatusText}
📦 <b>PRODUK:</b> ${orderData.product}
🔢 <b>KUANTITI:</b> ${orderData.quantity}
💰 <b>JUMLAH:</b> RM${amount}
👤 <b>MAKLUMAT PELANGGAN:</b>
📝 <b>Nama:</b> ${orderData.customerName}
📱 <b>No Telefon:</b> ${orderData.customerPhone}
🏠 <b>Alamat:</b> ${orderData.customerAddress}
📮 <b>Poskod:</b> ${orderData.poskod}
🗺️ <b>Negeri:</b> ${orderData.customerState}
💳 <b>JENIS PEMBAYARAN:</b> ${orderData.paymentMethod}
📅 <b>MASA:</b> ${orderDateTime}
⚠️ <b>SILA PROSESKAN PESANAN INI SECEPAT MUNGKIN</b>
            `;
            
            const url = `https://api.telegram.org/bot${TELEGRAM_CONFIG.botToken}/sendMessage`;
            const payload = {
                chat_id: TELEGRAM_CONFIG.chatId,
                text: message,
                parse_mode: 'HTML'
            };
            
            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });
                
                const data = await response.json();
                
                if (data.ok) {
                    return true;
                } else {
                    console.error('Telegram API error:', data);
                    return false;
                }
            } catch (error) {
                console.error('Error sending Telegram notification:', error);
                return false;
            }
        }

        // ====================================
        //      DISCORD NOTIFICATION
        // ====================================
        async function sendDiscordNotification(orderData) {
            // Format the date and time
            const orderDateTime = new Date().toLocaleString('ms-MY', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // Use codTotal for COD orders, total for online payment
            const amount = orderData.paymentMethod === 'COD' ? orderData.codTotal : orderData.total;
            
            // Create Discord embed message
            const discordMessage = {
                content: "🆕 **PESANAN BARU HASRASTORE** 🆕",
                embeds: [{
                    title: "Order Details",
                    color: 0x8b5cf6, // Purple color matching the site theme
                    fields: [
                        {
                            name: "Status Pembayaran",
                            value: orderData.paymentStatus === 'Paid' ? 
                                '✅ **TELAH DIBAYAR**' : 
                                '⏳ **MENUNGGU PEMBAYARAN**',
                            inline: false
                        },
                        {
                            name: "Produk",
                            value: orderData.product,
                            inline: false
                        },
                        {
                            name: "Kuantiti",
                            value: orderData.quantity.toString(),
                            inline: true
                        },
                        {
                            name: "Jumlah",
                            value: `RM${amount}`,
                            inline: true
                        },
                        {
                            name: "Nama Pelanggan",
                            value: orderData.customerName,
                            inline: false
                        },
                        {
                            name: "No Telefon",
                            value: orderData.customerPhone,
                            inline: true
                        },
                        {
                            name: "Alamat",
                            value: orderData.customerAddress,
                            inline: false
                        },
                        {
                            name: "Poskod",
                            value: orderData.poskod,
                            inline: true
                        },
                        {
                            name: "Negeri",
                            value: orderData.customerState,
                            inline: true
                        },
                        {
                            name: "Jenis Pembayaran",
                            value: orderData.paymentMethod,
                            inline: false
                        },
                        {
                            name: "Masa",
                            value: orderDateTime,
                            inline: false
                        }
                    ],
                    footer: {
                        text: "⚠️ SILA PROSESKAN PESANAN INI SECEPAT MUNGKIN"
                    },
                    timestamp: new Date().toISOString()
                }]
            };
            
            try {
                const response = await fetch('https://discord.com/api/webhooks/1417029319037030472/ahLpDXMTW-wj2YXRBX-a9b1iXFLLTB1oOq0w4it7mwInEcG3QETzBM9FETdL3DnmxzzM', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(discordMessage)
                });
                
                if (response.ok) {
                    return true;
                } else {
                    console.error('Discord API error:', response.status, response.statusText);
                    return false;
                }
            } catch (error) {
                console.error('Error sending Discord notification:', error);
                return false;
            }
        }

        // ====================================
        //      WHATSAPP ORDER FUNCTION
        // ====================================
        function generateWhatsAppURL(orderData, orderId) {
            const phoneNumber = '601127412402'; // Your business WhatsApp number
            
            const message = `Halo HASRASTORE,\n\nSaya ingin mengesahkan pesanan COD saya:\n\nOrder ID: ${orderId}\nNama: ${orderData.customerName}\nNo. Telefon: ${orderData.customerPhone}\nAlamat: ${orderData.customerAddress}\nPoskod: ${orderData.poskod}\nNegeri: ${orderData.customerState}\n\nProduk:\n${orderData.product}\nKuantiti: ${orderData.quantity}\nJumlah: RM${orderData.total}\n\nJumlah bayaran kepada posmen: RM${orderData.codTotal}\n\nSedia untuk bayar kepada posmen. Terima kasih.`;
            
            const encodedMessage = encodeURIComponent(message);
            return `https://api.whatsapp.com/send?phone=${phoneNumber}&text=${encodedMessage}`;
        }

        // ====================================
        //      TOYYIBPAY INTEGRATION
        // ====================================
        function generateBillNo() {
            const timestamp = Date.now();
            const random = Math.floor(Math.random() * 1000);
            return `TX${timestamp}${random}`;
        }
        
        function showPaymentRedirectModal(billCode) {
            const modal = document.getElementById('paymentRedirectModal');
            modal.classList.add('active');
            
            // Set up the redirect button
            document.getElementById('manualRedirectBtn').onclick = function() {
                window.location.href = `https://toyyibpay.com/${billCode}`;
            };
        }
        
        async function redirectToToyyibPay(orderData) {
            console.log('Starting ToyyibPay redirect with order data:', orderData);
            
            const billNo = generateBillNo();
            const amount = orderData.total;
            
            // Extract product code for shorter bill name
            let productCode = orderData.product;
            if (productCode.includes("Hitam")) {
                productCode = "Hitam";
            } else if (productCode.includes("Hijau green")) {
                productCode = "Hijaugreen";
            } else if (productCode.includes("Coklat")) {
                productCode = "Coklat";
            }
            
            // Calculate expiry date (3 days from now)
            const expiryDate = new Date();
            expiryDate.setDate(expiryDate.getDate() + 3);
            const formattedExpiryDate = 
                `${expiryDate.getDate().toString().padStart(2, '0')}-` +
                `${(expiryDate.getMonth() + 1).toString().padStart(2, '0')}-` +
                `${expiryDate.getFullYear()} ` +
                `${expiryDate.getHours().toString().padStart(2, '0')}:` +
                `${expiryDate.getMinutes().toString().padStart(2, '0')}:` +
                `${expiryDate.getSeconds().toString().padStart(2, '0')}`;
                
            // Prepare data for ToyyibPay API
            const formData = new FormData();
            formData.append('userSecretKey', TOYYIBPAY_CONFIG.userSecretKey);
            formData.append('categoryCode', TOYYIBPAY_CONFIG.categoryCode);
            formData.append('billName', `TitanX-H11 ${productCode}`);
            formData.append('billDescription', `Pembelian ${orderData.quantity} unit ${orderData.product}`);
            formData.append('billPriceSetting', 1); // Fixed amount
            formData.append('billPayorInfo', 1); // Require payer information
            formData.append('billAmount', amount * 100); // Convert to cents (RM89.90 = 8990)
            formData.append('billReturnUrl', TOYYIBPAY_CONFIG.returnUrl);
            formData.append('billCallbackUrl', TOYYIBPAY_CONFIG.callbackUrl);
            formData.append('billExternalReferenceNo', billNo);
            formData.append('billTo', orderData.customerName);
            formData.append('billEmail', 'hasrastore@gmail.com'); // Using your email as default
            formData.append('billPhone', orderData.customerPhone);
            formData.append('billSplitPayment', 0); // No split payment
            formData.append('billSplitPaymentArgs', '');
            formData.append('billPaymentChannel', 0); // All payment channels
            formData.append('billContentEmail', 'Terima kasih atas pembelian anda!');
            formData.append('billChargeToCustomer', 1); // Transaction cost deducted from merchant
            formData.append('billExpiryDate', formattedExpiryDate); // Bill expires in 3 days
            
            try {
                // Send request to ToyyibPay API
                const response = await fetch('https://toyyibpay.com/index.php/api/createBill', {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.text();
                
                // Log the response for debugging
                console.log('ToyyibPay API response status:', response.status);
                console.log('ToyyibPay API response text:', result);
                
                // Parse the JSON response to get the bill code
                let responseObj;
                try {
                    responseObj = JSON.parse(result);
                } catch (parseError) {
                    console.error('Error parsing JSON response:', parseError);
                    console.error('Raw response:', result);
                    alert('Ralat: Respon tidak sah dari pembekal pembayaran. Sila cuba lagi.');
                    return false;
                }
                
                // Try different ways to get the bill code
                let billCode = null;
                
                if (responseObj.BillCode) {
                    billCode = responseObj.BillCode;
                } else if (Array.isArray(responseObj) && responseObj.length > 0 && responseObj[0].BillCode) {
                    billCode = responseObj[0].BillCode;
                } else if (responseObj.billCode) {
                    billCode = responseObj.billCode;
                } else {
                    console.error('Unexpected response format:', responseObj);
                    alert('Ralat: Format respon tidak dijangka. Sila cuba lagi.');
                    return false;
                }
                
                console.log('Bill code extracted:', billCode);
                console.log('Redirect URL:', `https://toyyibpay.com/${billCode}`);
                
                if (billCode) {
                    // Store order data in localStorage for tracking on return
                    localStorage.setItem('pendingOrder', JSON.stringify({
                        orderData: orderData,
                        billNo: billNo,
                        totalAmount: amount
                    }));
                    
                    // Hide payment loading modal
                    hidePaymentLoading();
                    
                    // Show payment redirect modal
                    showPaymentRedirectModal(billCode);
                    return true;
                } else {
                    console.error('Failed to get bill code:', result);
                    alert('Ralat: Gagal menjana bil pembayaran. Sila cuba lagi.');
                    return false;
                }
            } catch (error) {
                console.error('Error creating ToyyibPay bill:', error);
                alert('Ralat: Tidak dapat menyambung ke pembekal pembayaran. Sila cuba lagi.');
                return false;
            }
        }

        // ====================================
        //      VOUCHER POPUP
        // ====================================
        const voucherPopup = document.getElementById('voucher-popup');
        const voucherCloseBtn = document.getElementById('voucher-close');
        const voucherClaimBtn = document.getElementById('voucher-claim-btn');
        const voucherMinutes = document.getElementById('voucher-minutes');
        const voucherSeconds = document.getElementById('voucher-seconds');
        
        // Always show voucher popup on page load
        setTimeout(() => {
            voucherPopup.classList.add('active');
            startVoucherTimer();
        }, 1000);
        
        // Close voucher popup
        voucherCloseBtn.addEventListener('click', () => {
            voucherPopup.classList.remove('active');
        });
        
        // Claim voucher button
        voucherClaimBtn.addEventListener('click', () => {
            const voucherClaimed = localStorage.getItem('voucherClaimed');
            
            if (voucherClaimed !== 'true') {
                localStorage.setItem('voucherClaimed', 'true');
                showNotification('Voucher berjaya diclaim! RM99.10 akan dipotong semasa pembayaran.', 'success');
                updateCart(); // Refresh cart display
            } else {
                showNotification('Anda telah claim voucher ini sebelum ini.', 'info');
            }
            
            voucherPopup.classList.remove('active');
        });
        
        // Start voucher countdown timer
        function startVoucherTimer() {
            let timeInSeconds = 15 * 60; // 15 minutes
            
            const voucherTimer = setInterval(() => {
                timeInSeconds--;
                
                const minutes = Math.floor(timeInSeconds / 60);
                const seconds = timeInSeconds % 60;
                
                voucherMinutes.textContent = minutes.toString().padStart(2, '0');
                voucherSeconds.textContent = seconds.toString().padStart(2, '0');
                
                if (timeInSeconds <= 0) {
                    clearInterval(voucherTimer);
                    voucherPopup.classList.remove('active');
                }
            }, 1000);
        }

        // ====================================
        //      NOTIFICATION SYSTEM
        // ====================================
        function showNotification(message, type = 'info') {
            const notificationContainer = document.getElementById('notification-container');
            const notificationEl = document.createElement('div');
            notificationEl.className = 'notification';
            
            if (type === 'success') {
                notificationEl.innerHTML = `
                    <div class="notification-content">
                        <div class="notification-title">Berjaya!</div>
                        <div class="notification-message">${message}</div>
                    </div>
                    <button class="notification-close">&times;</button>
                `;
            } else if (type === 'error') {
                notificationEl.innerHTML = `
                    <div class="notification-content">
                        <div class="notification-title">Ralat!</div>
                        <div class="notification-message">${message}</div>
                    </div>
                    <button class="notification-close">&times;</button>
                `;
            } else {
                notificationEl.innerHTML = `
                    <div class="notification-content">
                        <div class="notification-title">Maklumat</div>
                        <div class="notification-message">${message}</div>
                    </div>
                    <button class="notification-close">&times;</button>
                `;
            }
            
            notificationContainer.appendChild(notificationEl);
            
            // Add event listener to close button
            const closeBtn = notificationEl.querySelector('.notification-close');
            closeBtn.addEventListener('click', () => {
                notificationEl.remove();
            });
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                if (notificationEl.parentNode) {
                    notificationEl.remove();
                }
            }, 5000);
        }

        // ====================================
        //      SOCIAL PROOF NOTIFICATIONS
        // ====================================
        const socialProofNotifications = [
            "Ahmad Nazaruddin - Johor, order TitanX-H11 Hitam, Payment Online transfer 3 Jam 12 minutes yang lepas",
            "Muhammad Faris - Selangor, order TitanX-H11 Hijau, Payment Online transfer 1 Jam 45 minutes yang lepas",
            "Abdul Rahman - Pulau Pinang, order TitanX-H11 Hitam, Payment Online transfer 2 Jam 30 minutes yang lepas",
            "Ismail bin Yusof - Kedah, order TitanX-H11 Coklat, Payment Online transfer 4 Jam 5 minutes yang lepas",
            "Mohd Zain - Perak, order TitanX-H11 Hitam, Payment Online transfer 30 minutes yang lepas",
            "Rashid bin Ahmad - Negeri Sembilan, order TitanX-H11 Hijau, Payment Online transfer 2 Jam 15 minutes yang lepas",
            "Hassan bin Omar - Melaka, order TitanX-H11 Hitam, Payment Online transfer 5 Jam 20 minutes yang lepas",
            "Zainal Abidin - Pahang, order TitanX-H11 Coklat, Payment Online transfer 1 Jam 10 minutes yang lepas",
            "Azhar bin Sulaiman - Terengganu, order TitanX-H11 Hitam, Payment Online transfer 3 Jam 45 minutes yang lepas",
            "Yusof bin Ismail - Kelantan, order TitanX-H11 Hijau, Payment Online transfer 2 Jam 25 minutes yang lepas",
            "Fauzi bin Hassan - Sabah, order TitanX-H11 Hitam, Payment Online transfer 4 Jam 30 minutes yang lepas",
            "Khalid bin Rahman - Sarawak, order TitanX-H11 Coklat, Payment Online transfer 1 Jam 55 minutes yang lepas",
            "Salleh bin Musa - Kuala Lumpur, order TitanX-H11 Hitam, Payment Online transfer 45 minutes yang lepas",
            "Osman bin Bakar - Putrajaya, order TitanX-H11 Hijau, Payment Online transfer 2 Jam 40 minutes yang lepas",
            "Razak bin Hashim - Labuan, order TitanX-H11 Hitam, Payment Online transfer 3 Jam 5 minutes yang lepas"
        ];

        // Function to show social proof notification
        function showSocialProofNotification() {
            const randomNotification = socialProofNotifications[Math.floor(Math.random() * socialProofNotifications.length)];
            
            // Play notification sound
            const notificationSound = document.getElementById('notificationSound');
            if (notificationSound) {
                notificationSound.currentTime = 0;
                notificationSound.play().catch(e => console.log("Audio play failed:", e));
            }
            
            // Create notification element
            const notification = document.createElement('div');
            notification.className = 'social-proof-notification';
            notification.innerHTML = `
                <div class="notification-icon">
                    <i class="fas fa-bell"></i>
                </div>
                <div class="notification-content">
                    <p>${randomNotification}</p>
                </div>
            `;
            
            // Add notification to container
            const container = document.getElementById('notification-container');
            container.appendChild(notification);
            
            // Remove notification after 5 seconds
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 5000);
        }

        // Schedule social proof notifications
        function scheduleSocialProofNotifications() {
            // Show first notification after 5 seconds
            setTimeout(showSocialProofNotification, 5000);
            
            // Then show notifications at random intervals between 15-45 seconds
            setInterval(() => {
                showSocialProofNotification();
            }, Math.floor(Math.random() * 30000) + 15000);
        }

        // ====================================
        //      LOADING OVERLAY FUNCTIONS
        // ====================================
        function showLoading() {
            document.getElementById('loadingOverlay').classList.add('active');
        }
        
        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('active');
        }
        
        function showPaymentLoading() {
            document.getElementById('paymentLoadingModal').classList.add('active');
        }
        
        function hidePaymentLoading() {
            document.getElementById('paymentLoadingModal').classList.remove('active');
        }

        // Toggle Fact
        function toggleFact(element) {
            const factItem = element.parentElement;
            factItem.classList.toggle('active');
        }

        // Scroll to Pricing
        function scrollToPricing() {
            document.getElementById('pricing').scrollIntoView({ behavior: 'smooth' });
        }

        // Simulate Live Updates
        function simulateLiveUpdates() {
            setInterval(() => {
                // Randomly increase buyers
                if (Math.random() > 0.7) {
                    buyersToday += Math.floor(Math.random() * 3) + 1;
                    document.getElementById('buyersToday').textContent = buyersToday.toLocaleString();
                }
                
                // Randomly decrease stock
                if (Math.random() > 0.8 && stockLeft > 0) {
                    stockLeft -= Math.floor(Math.random() * 2) + 1;
                    if (stockLeft < 0) stockLeft = 0;
                    document.getElementById('stockLeft').textContent = stockLeft;
                    
                    if (stockLeft < 10) {
                        document.querySelector('.stock-counter').style.background = 'rgba(239, 68, 68, 0.2)';
                    }
                }
            }, 5000);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            startCountdown();
            simulateLiveUpdates();
            updateCart();
            scheduleSocialProofNotifications();
            
            // Fix for anchor link handling that might be causing the error
            document.querySelectorAll('a[href]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    const href = this.getAttribute('href');
                    
                    // Skip handling for external links (like WhatsApp)
                    if (href.startsWith('http') || href.startsWith('https://api.whatsapp.com')) {
                        return; // Let the default behavior happen
                    }
                    
                    // Handle internal page links
                    e.preventDefault();
                    const target = document.querySelector(href);
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth' });
                    }
                });
            });
            
            // Add smooth scroll behavior
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth' });
                    }
                });
            });

            // Optimize scroll event listeners with debounce
            window.addEventListener('scroll', debounce(function() {
                const navbar = document.querySelector('.navbar');
                if (window.scrollY > 50) {
                    navbar.style.background = 'rgba(15, 23, 42, 0.98)';
                } else {
                    navbar.style.background = 'rgba(15, 23, 42, 0.95)';
                }
            }, 100));
            
            // Add real-time validation for form fields
            document.getElementById('customerName').addEventListener('blur', function() {
                if (!this.value.trim()) {
                    document.getElementById('nameError').style.display = 'block';
                    this.classList.add('error');
                } else {
                    document.getElementById('nameError').style.display = 'none';
                    this.classList.remove('error');
                }
            });
            
            document.getElementById('customerPhone').addEventListener('blur', function() {
                const phoneRegex = /^0\d{9,10}$/;
                if (!phoneRegex.test(this.value.trim())) {
                    document.getElementById('phoneError').style.display = 'block';
                    this.classList.add('error');
                } else {
                    document.getElementById('phoneError').style.display = 'none';
                    this.classList.remove('error');
                }
            });
            
            document.getElementById('customerAddress').addEventListener('blur', function() {
                if (!this.value.trim()) {
                    document.getElementById('addressError').style.display = 'block';
                    this.classList.add('error');
                } else {
                    document.getElementById('addressError').style.display = 'none';
                    this.classList.remove('error');
                }
            });
            
            document.getElementById('customerPostcode').addEventListener('blur', function() {
                const postcodeRegex = /^\d{5}$/;
                if (!postcodeRegex.test(this.value.trim())) {
                    document.getElementById('postcodeError').style.display = 'block';
                    this.classList.add('error');
                } else {
                    document.getElementById('postcodeError').style.display = 'none';
                    this.classList.remove('error');
                }
            });
            
            document.getElementById('customerState').addEventListener('change', function() {
                if (!this.value) {
                    document.getElementById('stateError').style.display = 'block';
                    this.classList.add('error');
                } else {
                    document.getElementById('stateError').style.display = 'none';
                    this.classList.remove('error');
                }
                
                // Check if COD is selected and state is Sabah or Sarawak
                const paymentMethod = document.querySelector('input[name="payment"]:checked').value;
                if (paymentMethod === 'cod' && (this.value === 'sabah' || this.value === 'sarawak')) {
                    showNotification('COD tidak tersedia untuk Sabah & Sarawak', 'error');
                    document.getElementById('onlinePayment').checked = true;
                }
            });
        });
    </script>
</body>
</html>